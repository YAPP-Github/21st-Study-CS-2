## IPC

프로세스 간 의사소통하는 것을 IPC(Inter Process Communication)라고 한다. 프로세스는 OS로부터 할당된 독립적인 공간을 갖는다. 경우에 따라 프로세스 간 통신이 필요할 때가 있는데 독립되어 있는 만큼 별도의 설비 없이 통신이 어렵다. 그래서 이를 해결하고나 커널 영역에서 IPC를 제공한다.

### Shared Memory

- 프로세스간 메모리 영역을 공유해서 사용할 수 있도록 한다.
- 공유한 메모리 영역에 read/write를 통해 통신한다.
- 프로세스가 공유 메모리 할당을 커널에 요청하면 해당 프로세스에 메모리 공간을 할당한다. 다른 프로세스도 해당 메모리 영역에 접근할 수 있고, 공유 메모리가 각 프로세스에 attach 하는 방식으로 작동한다.
- 공유 메모리가 설정되면 이후에는 커널의 관여 없이 통신할 수 있다.

장점

- 중개자(커널) 없이 바로 메모리에 접근할 수 있기에 모든 IPC 중 가장 빠르게 동작한다.
- 프로그램 레벨에서 통신 기능을 제공하여 자유로운 통신이 가능하다.

단점

- 프로세스 A에서 B로 메시지를 전달하는 방식이 아니기에 데이터를 읽어야 하는 시점을 알 수 없다. 즉 프로세스 A가 공유 메모리에 데이터를 write 했을 때 이를 프로세스 B는 모른다. → 동기화 작업이 필요하다.
- 동시에 같은 메모리 위치에 접근하게 될 수 있다. → 공유 메모리 Lock 메커니즘이 필요하다.

### Message Passing

- 커널 메모리 영역에 메시지 전달을 위한 채널을 만들어서 프로세스들 사이에 메시지를 송수신하는 방법이다.
- 커널을 경유해서 메시지를 주고 받으며, 커널에서는 데이터를 버퍼링한다.
- 프로세스 A가 커널로 메시지를 보내면 커널이 프로세스 B에게 메시지를 전달하는 방식
- 프로세스 간 메모리 공유 없이 동작할 수 있다.
- 별도의 동기화 로직이 필요없다.
- 커널을 통해서 데이터를 주고받기에 shared memory 보다 느리다.

**익명 파이프 (Anonymous PIPE)**

- producer-consumer 스타일로 통신한다. 즉 producer가 쓰고, consumer가 읽는 단방향 통신이다.
- 부모-자식 프로세스간 통신에 사용한다.
- FIFO 구조
- 양방향 통신을 하려면 파이프를 따로 하나 더 만들어야 한다.
- 기본적으로 block 모드로 동작하므로 한 프로세스가 read 중이면 끝나기 전까지 read하고자 하는 다른 프로세스는 대기한다. write도 마찬가지

**Named PIPE**

- 이름을 가진 파이프를 통해 프로세스 간 단방향 통신을 지원한다.
- 통신에 이름이 있는 파일을 사용하기에 모든 프로세스가 파이프의 이름만 알면 통신이 가능하다.
- 익명파이프와 마찬가지로 양방향 통신을 하려면 파이프가 하나 더 필요하다.
- 기본적으로 block 모드로 동작하므로 한 프로세스가 read 중이면 끝나기 전까지 read하고자 하는 다른 프로세스는 대기한다. write도 마찬가지

**Message Queue**

- FIFO로 동작하는 큐를 사용한다.
- 스트림 기반을 동작하는 파이프와 달리 메시지 큐는 메시지 또는 패킷 단위로 동작한다.
- 어느 프로세스 간에도 송수신이 가능하다.
- 양방향 통신이 가능하며 메시지의 형태를 사용자가 정의해 사용할 수 있다.
- 데이터에 번호를 붙여서 여러 프로세스가 데이터를 쉽게 다룰 수 있도록 한다.
- 비동기 방식으로 처리량이 많으면 큐에 넣은 후 나중에 처리할 수 있다.
- 메모리 공간을 사용하므로 데이터가 쌓일수록 메모리 자원을 필요로한다.

**Socket**

- 소켓은 네트워크 상에서 임의의 포트를 정하고 해당 포트를 통해 데이터를 주고 받을 때 많이 사용한다. 소켓의 네트워크 기능을 이용해 IPC로도 사용할 수 있다.
- Client-Server 구조로 통신하며 원격에서 프로세스 간 데이터를 공유할 때 사용할 수 있다.
- 프로세스는 포트 번호로 통신하려는 상대 소켓을 찾는다.
- 양방향 통신이 가능하다.
