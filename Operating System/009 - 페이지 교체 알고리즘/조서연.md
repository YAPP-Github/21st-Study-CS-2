## 페이지 교체 알고리즘

운영체제는 메인 메모리보다 큰 프로그램을 실행하기 위해 가상 메모리를 사용한다. 현재 실행에 필요한 일부분만 메인 메모리에 로드하고 나머지는 디스크에 두는 것이다.  

필요한 페이지가 메모리에 없으면 페이지 폴트가 발생한다. 페이지 폴트가 발생하면 필요한 페이지를 디스크에서 찾아 빈 프레임에 로딩한다. 그런데 빈 프레임이 없을 경우 현재 할당된 페이지 중 victim page를 골라 교체해야 한다. 스왑 영역으로 보낼 페이지를 결정하는 알고리즘을 페이지 교체 알고리즘이라고 한다. 알고리즘의 목표는 앞으로 사용할 가능성이 적은 페이지를 victim page로 선정해 페이지 폴트 발생 비율을 줄이는 것이다.

최적의 페이지 교체 알고리즘을 선택하기 위해서는 성능 평가 기준이 있어야 한다. 페이지 폴트 횟수, 계산량, 메모리를 얼마나 차지하는지 등이 성능 평가의 기준이 될 수 있다.

### Random page replacement

- 특별한 로직 없이 무작위로 victim page를 선택한다.
- 간단하게 구현할 수 있지만 지역성을 전혀 고려하지 않기에 성능이 좋지 않다.

### FIFO

- First In First Out
- 메모리에 **가장 먼저 올라온 페이지**가 먼저 내보내진다.
- 구현이 간단하다. 큐로 쉽게 구현할 수 있다.
- 처음 프로세스가 실행될 때 초기화 코드에서 사용하기에 적절하다.
- Belady’s Anomaly - 프레임 개수가 많아져도 페이지 폴트가 줄지 않고 늘어나는 현상. 일반적으로 프레임이 증가하면 메모리에 더 많은 페이지가 올라올 수 있으므로 페이지 폴트가 줄어든다.

### OPT

- Optional page replacement
- **앞으로 가장 오랫동안 사용하지 않을 페이지**를 내보낸다.
- 페이지 폴트를 많이 감소시킬 수 있지만 실질적으로 앞으로 잘 사용되지 않을 페이지를 예측하는 것은 현실적으로 구현이 어렵다.

### LRU

- Least Recently Used
- **최근에 사용하지 않은 페이지(가장 오래 사용되지 않은 페이지)**를 내보낸다. 실제로도 시간 지역성의 성질로, 최근에 사용되지 않은 페이지가 앞으로도 사용되지 않을 확률이 높아 많은 운영체제에서 채택하는 방식이다. 최근에 참조된 페이지가 가까운 미래에 다시 참조될 가능성이 높다.
- 예측을 해야하는 OPT와 달리 과거 기록으로 판단하는 것이기에 실질적으로 사용 가능하다.

### LFU

- Least Frequently Used
- **참조 횟수가 가장 적은 페이지**를 내보낸다. 교체 대상이 여러 개라면 가장 오랫동안 사용하지 않은 페이지를 내보낸다.
- Incache-LFU
    
    메모리에 올라올 때부터 페이지의 참조 횟수를 카운트한다.
    
- Perfect-LFU
    
    메모리 적재 여부와 상관 없이 페이지의 과거 총 참조 횟수를 카운트한다.
    

### MFU

- Most Frequently Used
- LFU와 반대로 **참조 횟수가 가장 많은 페이지**를 내보낸다. 참조 횟수가 적은 페이지가 최근에 사용된 페이지일 확률이 높고, 최근에 사용된 페이지는 앞으로 사용될 가능성이 높기에 참조 횟수가 적은 페이지를 택한다.

### NUR

- Not Used Recently
- 하드웨어 자원을 활용해 기존 LRU, LFU 알고리즘의 소프트웨어적인 오버헤드를 줄인 방식이다.
- 페이지마다 참조 비트 r, 수정 비트 m을 사용한다. 참조 여부과 수정 여부에 따른 우선순위에 따라 적합한 페이지를 교체한다.

### 교체 방식

다중 프로그래밍 환경에서는 메인 메모리에 여러 프로세스가 올라와 있을 수 있다. victim page를 선택할 때 선정 기준을 글로벌로 할 수도 있고, 로컬로 할 수도 있다.

- Global 교체
    
    메모리 상의 모든 프로세스 페이지에 대해 교체한다. 
    
- Local 교체
    
    메모리 상의 자기 프로세스 페이지에서만 교체한다.
